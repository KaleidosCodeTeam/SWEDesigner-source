<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: server/DAO/DAO.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: server/DAO/DAO.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 *  @file Contiene la classe statica DAO
 *  @author Sanna Giovanni - KaleidosCode
 *
 *  @requires mysql
 */

var mysql = require('mysql');

/*
var ris = function() {
  this.r = "x";
  this.setR = function(nr) { this.r = nr; }
}
*/

/** 
 * @namespace
 * @description Espone le funzionalità che permettono di interagire con il database delle bubbles,
 * in particolare inserire/eliminare una bubble, controllare se è presultente una specifica bubble, ottenere le
 * informazioni di una particolare bubble o ottenere le informazioni di tutte le bubble memorizzate.
 */
var DAO = (function() {
    var _private = {
        /** 
         *  @var {string} DAO.host_ - L'hostname del database mysql a cui connettersi.
         *  @private
         */
    		host_      : 'sql11.freemysqlhosting.net',
        /** 
         *  @var {string} DAO.user - Lo username per il login al database.
         *  @private
         */
      	user       : 'sql11180510',
        /** 
         *  @var {string} DAO.password - La password per il login al database.
         *  @private
         */
      	password   : 'dvxPEVmife',
        /** 
         *  @var {string} DAO.database - Il nome del database a cui connettersi.
         *  @private
         */
      	database   : 'sql11180510',
        /** 
         *  @var {Object} DAO.connection - La connessione al database.
         *  @private
         */
      	connection :  mysql.createConnection({
            host     : 'sql11.freemysqlhosting.net',
            user     : 'sql11180510',
            password : 'dvxPEVmife',
            database : 'sql11180510'
        }),
    };
    /**
     *  @function DAO._startConnection
     *  @descripton Inizializza l'oggetto DAO._private.connection e esegue la connessione al database.
     *  @private
     */
    _startConnection = function() {
        _private.connection = mysql.createConnection({
            host     : _private.host_,
            user     : _private.user,
            password : _private.password,
            database : _private.database
        });
        _private.connection.connect();
    };
    return {
        /**
         *  @function DAO.setConnection
         *  @param {!string} host - L'hostname del database mysql a cui connettersi.
         *  @param {!string} user - L'username per il login al database.
         *  @param {!string} psw - La password per il login al database.
         *  @param {!string} db - Il nome del database a cui connettersi.
         *  @descripton Setta le proprietà di DAO._private necessarie a creare una connessione.
         */
      	setConnection : function(host, user, psw, db) {
      		  _private.host_ = host;
      		  _private.user = user;
      		  _private.password = psw;
      		  _private.database = db;
      	},
        /**
         *  @function DAO.insertBubble
         *  @param {!string} name - Attributo 'Name' della bubble da inserire.
         *  @param {!string} source - Attributo 'Source' della bubble da inserire.
         *  @param {!string} language - Attributo 'Language' della bubble da inserire.
         *  @param {!string} descr - Attributo 'Description' della bubble da inserire.
         *  @descripton Inserisce una nuova bubble nel database.
         *  @throw mysql exception
         */
      	insertBubble : function(name, source, language, descr, result) {
            _startConnection();
        		_private.connection.query('insert into Bubbles  values("' + name + '","' + descr + '","' + source + '","' + language +'");', function(err, rows, fields) {
          			if (!err) {
                    if (result) { result.setR('Insertion of ' + name + " in " + language + " DONE."); }
                } else {
            			  throw err;
                }
        		});
            _private.connection.end();
      	},
        /**
         *  @function DAO.deleteBubble
         *  @param {!string} name - Attributo 'Name' della bubble da eliminare.
         *  @param {!string} language - Attributo 'Language' della bubble da eliminare.
         *  @descripton Elimina una bubble dal database.
         *  @throw mysql exception
         */
        deleteBubble : function(name, language, result) {
            _startConnection();
            _private.connection.query('delete from Bubbles where Name="' + name + '" and Language="' + language + '";', function(err, rows, fields) {
                if (!err) {
                    if(result) { result.setR('Delete of ' + name + " in " + language + " DONE."); }
                } else {
                    throw err;
                }
            });
            _private.connection.end();
        },
        /**
         *  @function DAO.getBubble
         *  @param {!string} name - Attributo 'Name' della bubble cercata.
         *  @param {!string} language - Attributo 'Language' della bubble cercata.
         *  @descripton Restituisce le informazioni della bubble cercata, se questa esiste.
         *  @throw mysql exception
         */
      	getBubble : function(name, language, result) {
        		_startConnection();
        		_private.connection.query('select * from Bubbles where Name="' + name + '" and Language="' + language + '";', function(err, rows, fields) {
          			if (!err) {
                    if (rows.length > 0) {
                        console.log(rows);
                        if (result) { result.setR(rows); }
                    } else {
                        console.log(null);
                    }
                } else {
            			  throw err;
                }
        		});
        		_private.connection.end();
      	},
        /**
         *  @function DAO.getAllBubble
         *  @descripton Restituisce le informazioni di tutte le bubble presenti nel database.
         *  @throw mysql exception
         */
        getAllBubbles : function(result) {
            _startConnection();
            _private.connection.query('select * from Bubbles;', function(err, rows, fields) {
                if (!err) {
                    console.log(rows);
                    if (result) { result.setR(rows); }
                } else {
                    throw err;
                }
            });
            _private.connection.end();
        },
        /**
         *  @function DAO.isPresentBubble
         *  @param {!string} name - Attributo 'Name' della bubble cercata.
         *  @param {!string} language - Attributo 'Language' della bubble cercata.
         *  @descripton Controlla se una specifica bubble è presente nel database.
         *  @throw mysql exception
         */
        isPresentBubble : function(name, language, result) {
            _startConnection();
            _private.connection.query('select * from Bubbles where Name="' + name + '" and Language="' + language + '";', function(err, rows, fields,r) {
                if (!err) {
                    if (rows.length > 0) { 
                        console.log(true); 
                        if (result) { result.setR(true); }
                    } else {
                        console.log(false); 
                        if(result) { result.setR(false); }
                    }
                } else {
                    throw err;
                }
            });
            _private.connection.end(); 
        }
    };
}());

/**  Esportazione del modulo */
module.exports = DAO;


//var d = new DAO();

//d.insertBubble("pedone","...codice...","Javascript","");
//d.getBubble("Mossa","Javascript");
//d.getBubble("Mossa","Javascript");

//console.log(d.isPresultentBubble("",""));
//console.log(d.isPresultentBubble("Mossa","Javascript"));

// create table Bubbles ( Name INT NOT NULL PRIMARY KEY, Description VARCHAR(100), Source VARCHAR(1000), Language VARCHAR(20)
// insert into Bubbles  values("Scacchiera","codice per disegnare scacchiera","...codice...","Java");
// insert into Bubbles  values("Mossa","codice per eseguire una mossa","...codice...","Java");</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Aggregation.html">Aggregation</a></li><li><a href="Association.html">Association</a></li><li><a href="Base.html">Base</a></li><li><a href="BaseView.html">BaseView</a></li><li><a href="bubbleDiagramLink.html">bubbleDiagramLink</a></li><li><a href="bubbleElse.html">bubbleElse</a></li><li><a href="bubbleFor.html">bubbleFor</a></li><li><a href="bubbleIf.html">bubbleIf</a></li><li><a href="bubbleLink.html">bubbleLink</a></li><li><a href="bubbleReturn.html">bubbleReturn</a></li><li><a href="bubbleStart.html">bubbleStart</a></li><li><a href="bubbleWhile.html">bubbleWhile</a></li><li><a href="Class.html">Class</a></li><li><a href="classDiagramLink.html">classDiagramLink</a></li><li><a href="ClComment.html">ClComment</a></li><li><a href="ClCommentLink.html">ClCommentLink</a></li><li><a href="ClCommentView.html">ClCommentView</a></li><li><a href="CodedProgram.html">CodedProgram</a></li><li><a href="Composition.html">Composition</a></li><li><a href="customBubble.html">customBubble</a></li><li><a href="EditPanelView.html">EditPanelView</a></li><li><a href="Generalization.html">Generalization</a></li><li><a href="Implementation.html">Implementation</a></li><li><a href="Interface.html">Interface</a></li><li><a href="MainView.html">MainView</a></li><li><a href="Package.html">Package</a></li><li><a href="packageDiagramLink.html">packageDiagramLink</a></li><li><a href="PathView.html">PathView</a></li><li><a href="PkgComment.html">PkgComment</a></li><li><a href="PkgCommentLink.html">PkgCommentLink</a></li><li><a href="PkgCommentView.html">PkgCommentView</a></li><li><a href="PkgDependency.html">PkgDependency</a></li><li><a href="Project.html">Project</a></li><li><a href="ProjectModel.html">ProjectModel</a></li><li><a href="RequestHandler.html">RequestHandler</a></li><li><a href="TitlebarView.html">TitlebarView</a></li><li><a href="ToolbarModel.html">ToolbarModel</a></li><li><a href="ToolbarView.html">ToolbarView</a></li></ul><h3>Namespaces</h3><ul><li><a href="Builder.html">Builder</a></li><li><a href="codeGenerator.html">codeGenerator</a></li><li><a href="CoderAttribute.html">CoderAttribute</a></li><li><a href="CoderClass.html">CoderClass</a></li><li><a href="CoderOperation.html">CoderOperation</a></li><li><a href="CoderParameter.html">CoderParameter</a></li><li><a href="DAO.html">DAO</a></li><li><a href="JavaCoder.html">JavaCoder</a></li><li><a href="JavascriptCoder.html">JavascriptCoder</a></li><li><a href="Parser.html">Parser</a></li><li><a href="Zipper.html">Zipper</a></li></ul><h3>Global</h3><ul><li><a href="global.html#getNameById">getNameById</a></li><li><a href="global.html#getOperationById">getOperationById</a></li><li><a href="global.html#getPackNameById">getPackNameById</a></li><li><a href="global.html#requirejs">requirejs</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Tue Jul 04 2017 15:46:59 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
